D:\Devs\Matmul>gcc -O3 -fopenmp -mavx2 -mfma -std=c11 -o test test.c src/naive_matmul.c src/trans_matmul.c src/kernels/blocked.c src/kernels/openmp.c src/kernels/simd.c -lm

D:\Devs\Matmul>test
Matrix Multiplication Comprehensive Benchmark Suite
===================================================
System Info:
OpenMP threads: 6
Available processors: 6

============================================================
TEST 1/8

=== Standard Matrix Multiplication Implementations ===
A: 128x128, B: 128x128, Output: 128x128

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Naive (Reference)                       0.002000         1.00x        YES
OpenMP                                  0.002000         1.00x        YES
SIMD (AVX2)                             0.000000          infx        YES
Blocked                                 0.001000         2.00x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.000000          infx        YES

=== Transposed Matrix Multiplication Implementations ===
A: 128x128, B: 128x128, Output: 128x128

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.001000         1.00x        YES
OpenMP Transposed                       0.001000         1.00x        YES
SIMD Transposed                         0.000000          infx        YES
SIMD Blocked Transposed                 0.000000          infx        YES
Blocked Transposed                      0.001000         1.00x        YES
Hybrid Transposed                       0.001000         1.00x        YES

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 128x128, B: 128x128, Output: 128x128

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive               0.002000     0.001000         2.10         4.19 Transposed
OpenMP              0.001000     0.001000         4.19         4.19 Transposed
SIMD                0.000000     0.000000          inf          inf Transposed
Blocked             0.001000     0.001000         4.19         4.19 Transposed
Hybrid              0.000000     0.001000          inf         4.19   Standard

============================================================
TEST 2/8

=== Standard Matrix Multiplication Implementations ===
A: 256x256, B: 256x256, Output: 256x256

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Naive (Reference)                       0.017000         1.00x        YES
OpenMP                                  0.007000         2.43x        YES
SIMD (AVX2)                             0.003000         5.67x        YES
Blocked                                 0.017000         1.00x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.001000        17.00x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 256x256, B: 256x256, Output: 256x256

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.014000         1.00x        YES
OpenMP Transposed                       0.005000         2.80x        YES
SIMD Transposed                         0.003000         4.67x        YES
SIMD Blocked Transposed                 0.003000         4.67x        YES
Blocked Transposed                      0.009000         1.56x        YES
Hybrid Transposed                       0.003000         4.67x        YES

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 256x256, B: 256x256, Output: 256x256

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive               0.022000     0.013000         1.53         2.58 Transposed
OpenMP              0.006000     0.004000         5.59         8.39 Transposed
SIMD                0.003000     0.003000        11.18        11.18 Transposed
Blocked             0.019000     0.010000         1.77         3.36 Transposed
Hybrid              0.001000     0.002000        33.55        16.78   Standard

============================================================
TEST 3/8

=== Standard Matrix Multiplication Implementations ===
A: 512x256, B: 256x128, Output: 512x128

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Naive (Reference)                       0.022000         1.00x        YES
OpenMP                                  0.005000         4.40x        YES
SIMD (AVX2)                             0.003000         7.33x        YES
Blocked                                 0.011000         2.00x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.002000        11.00x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 512x256, B: 256x128, Output: 512x128

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.014000         1.00x        YES
OpenMP Transposed                       0.004000         3.50x        YES
SIMD Transposed                         0.002000         7.00x        YES
SIMD Blocked Transposed                 0.002000         7.00x        YES
Blocked Transposed                      0.009000         1.56x        YES
Hybrid Transposed                       0.002000         7.00x        YES

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 512x256, B: 256x128, Output: 512x128

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive               0.021000     0.014000         1.60         2.40 Transposed
OpenMP              0.005000     0.003000         6.71        11.18 Transposed
SIMD                0.003000     0.002000        11.18        16.78 Transposed
Blocked             0.011000     0.010000         3.05         3.36 Transposed
Hybrid              0.002000     0.002000        16.78        16.78 Transposed

============================================================
TEST 4/8

=== Standard Matrix Multiplication Implementations ===
A: 512x512, B: 512x512, Output: 512x512

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Naive (Reference)                       0.368000         1.00x        YES
OpenMP                                  0.103000         3.57x        YES
SIMD (AVX2)                             0.045000         8.18x        YES
Blocked                                 0.286000         1.29x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.013000        28.31x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 512x512, B: 512x512, Output: 512x512

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.108000         1.00x        YES
OpenMP Transposed                       0.029000         3.72x        YES
SIMD Transposed                         0.021000         5.14x        YES
SIMD Blocked Transposed                 0.017000         6.35x        YES
Blocked Transposed                      0.074000         1.46x        YES
Hybrid Transposed                       0.008000        13.50x         NO

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 512x512, B: 512x512, Output: 512x512

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive               0.374000     0.105000         0.72         2.56 Transposed
OpenMP              0.113000     0.026000         2.38        10.32 Transposed
SIMD                0.048000     0.020000         5.59        13.42 Transposed (MISMATCH!)
Blocked             0.289000     0.061000         0.93         4.40 Transposed
Hybrid              0.009000     0.010000        29.83        26.84   Standard (MISMATCH!)

============================================================
TEST 5/8

=== Standard Matrix Multiplication Implementations ===
A: 1024x512, B: 512x256, Output: 1024x256
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
OpenMP                                  0.044000         1.00x        YES
SIMD (AVX2)                             0.031000         1.42x        YES
Blocked                                 0.157000         0.28x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.006000         7.33x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 1024x512, B: 512x256, Output: 1024x256
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.112000         1.00x        YES
OpenMP Transposed                       0.038000         2.95x        YES
SIMD Transposed                         0.018000         6.22x        YES
SIMD Blocked Transposed                 0.015000         7.47x        YES
Blocked Transposed                      0.068000         1.65x        YES
Hybrid Transposed                       0.009000        12.44x         NO

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 1024x512, B: 512x256, Output: 1024x256
Note: Naive comparison disabled for large matrices (>512 in any dimension)

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive                SKIPPED      SKIPPED            -            -          -
OpenMP              0.044000     0.027000         6.10         9.94 Transposed
SIMD                0.027000     0.020000         9.94        13.42 Transposed
Blocked             0.138000     0.064000         1.95         4.19 Transposed
Hybrid              0.012000     0.013000        22.37        20.65   Standard

============================================================
TEST 6/8

=== Standard Matrix Multiplication Implementations ===
A: 1024x1024, B: 1024x1024, Output: 1024x1024
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
OpenMP                                  1.764000         1.00x        YES
SIMD (AVX2)                             0.925000         1.91x        YES
Blocked                                 3.939000         0.45x        YES
Hybrid (OpenMP+SIMD+Blocked)            0.141000        12.51x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 1024x1024, B: 1024x1024, Output: 1024x1024
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  0.904000         1.00x        YES
OpenMP Transposed                       0.199000         4.54x        YES
SIMD Transposed                         0.242000         3.74x         NO
SIMD Blocked Transposed                 0.143000         6.32x         NO
Blocked Transposed                      0.533000         1.70x        YES
Hybrid Transposed                       0.059000        15.32x         NO

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 1024x1024, B: 1024x1024, Output: 1024x1024
Note: Naive comparison disabled for large matrices (>512 in any dimension)

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive                SKIPPED      SKIPPED            -            -          -
OpenMP              1.610000     0.189000         1.33        11.36 Transposed
SIMD                1.030000     0.240000         2.08         8.95 Transposed (MISMATCH!)
Blocked             3.763000     0.549000         0.57         3.91 Transposed
Hybrid              0.102000     0.052000        21.05        41.30 Transposed (MISMATCH!)

============================================================
TEST 7/8

=== Standard Matrix Multiplication Implementations ===
A: 4096x1024, B: 1024x3072, Output: 4096x3072
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
OpenMP                                 21.205000         1.00x        YES
SIMD (AVX2)                            11.214000         1.89x        YES
Blocked                                41.653000         0.51x        YES
Hybrid (OpenMP+SIMD+Blocked)            1.179000        17.99x        YES

=== Transposed Matrix Multiplication Implementations ===
A: 4096x1024, B: 1024x3072, Output: 4096x3072
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                  9.874000         1.00x        YES
OpenMP Transposed                       2.403000         4.11x        YES
SIMD Transposed                         2.514000         3.93x         NO
SIMD Blocked Transposed                 1.268000         7.79x         NO
Blocked Transposed                      5.835000         1.69x        YES
Hybrid Transposed                       0.558000        17.70x         NO

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 4096x1024, B: 1024x3072, Output: 4096x3072
Note: Naive comparison disabled for large matrices (>512 in any dimension)

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive                SKIPPED      SKIPPED            -            -          -
OpenMP             22.053000     2.437000         1.17        10.57 Transposed
SIMD               11.130000     2.703000         2.32         9.53 Transposed (MISMATCH!)
Blocked            41.738000     5.832000         0.62         4.42 Transposed
Hybrid              1.150000     0.542000        22.41        47.55 Transposed (MISMATCH!)

============================================================
TEST 8/8

=== Standard Matrix Multiplication Implementations ===
A: 4096x4096, B: 4096x4096, Output: 4096x4096
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
OpenMP                                542.489000         1.00x        YES
SIMD (AVX2)                           141.833000         3.82x         NO
Blocked                              2102.718000         0.26x        YES
Hybrid (OpenMP+SIMD+Blocked)            8.134000        66.69x         NO

=== Transposed Matrix Multiplication Implementations ===
A: 4096x4096, B: 4096x4096, Output: 4096x4096
Note: Naive implementation disabled for large matrices (>512 in any dimension)

Implementation                          Time (s)      Speedup    Correct
==============                          ========      =======    =======
Transposed (Reference)                 53.406000         1.00x        YES
OpenMP Transposed                      11.313000         4.72x        YES
SIMD Transposed                        15.253000         3.50x         NO
SIMD Blocked Transposed                 8.224000         6.49x         NO
Blocked Transposed                     32.335000         1.65x        YES
Hybrid Transposed                       2.599000        20.55x         NO

=== STANDARD vs TRANSPOSED COMPARISON ===
A: 4096x4096, B: 4096x4096, Output: 4096x4096
Note: Naive comparison disabled for large matrices (>512 in any dimension)

Method           Std Time(s) Trans Time(s)   Std GFLOPS Trans GFLOPS     Winner
======           =========== ============   ==========  ===========     ======
Naive                SKIPPED      SKIPPED            -            -          -
OpenMP            520.500000    14.200000         0.26         9.68 Transposed
SIMD              135.172000    15.409000         1.02         8.92 Transposed (MISMATCH!)
Blocked          2006.486000    31.274000         0.07         4.39 Transposed
Hybrid              7.782000     2.657000        17.66        51.73 Transposed (MISMATCH!)

============================================================
SUMMARY
Standard implementations: naive (small matrices only), openmp, simd, blocked, hybrid
Transposed implementations: transposed, openmp_transpose, simd_transpose, simd_transpose_blocked, blocked_transpose, hybrid_transposed
Direct comparisons show performance differences between standard and transposed approaches
SIMD operations process 8 floats simultaneously using AVX2
Blocked algorithms use 64x64 tiles for cache efficiency
Hybrid combines OpenMP + SIMD + blocking for maximum performance
Naive implementation automatically disabled for matrices >512 in any dimension

D:\Devs\Matmul>